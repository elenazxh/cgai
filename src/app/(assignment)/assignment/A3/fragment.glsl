uniform float iTime;
uniform vec2 iResolution;

//======================================================= Copy-Paste Area Begin =========================================================
/* Default
// Number of Gaussians
const int NUM_GAUSSIANS = 2;
// Dimensions [x_min, x_max, y_min, y_max]
float dim[4] = float[4](-5.0,5.0,-5.0,5.0);
// Centers (x, y coordinates)
vec2 gauss_centers[NUM_GAUSSIANS] = vec2[NUM_GAUSSIANS](vec2(-3.00, 1.50),vec2(1.50, 2.50));
// Sigmas (scales)
vec2 gauss_sigmas[NUM_GAUSSIANS] = vec2[NUM_GAUSSIANS](vec2(2.00, 1.50),vec2(1.50, 0.50));
// Rotation angles (thetas)
float gauss_thetas[NUM_GAUSSIANS] = float[NUM_GAUSSIANS](0.20,0.80);
// Colors (RGB)
vec3 gauss_colors[NUM_GAUSSIANS] = vec3[NUM_GAUSSIANS](vec3(0.70, 0.10, 0.20),vec3(0.30, 0.80, 0.10));
*/

// Mona Lisa
// Number of Gaussians
const int NUM_GAUSSIANS = 150;
// Dimensions [x_min, x_max, y_min, y_max]
float dim[4] = float[4](-5.0,5.0,-7.552816901408451,7.552816901408451);
// Centers (x, y coordinates)
vec2 gauss_centers[NUM_GAUSSIANS] = vec2[NUM_GAUSSIANS](vec2(4.91, 6.63),vec2(-4.55, -1.38),vec2(-2.47, 5.60),vec2(-0.66, -2.06),vec2(3.54, 2.81),vec2(-0.10, 7.98),vec2(2.54, -1.60),vec2(0.04, 2.92),vec2(2.28, 0.23),vec2(-4.26, 1.54),vec2(2.60, 6.72),vec2(3.93, 1.31),vec2(4.53, -2.76),vec2(-4.11, -0.75),vec2(0.86, 0.70),vec2(0.73, 6.42),vec2(-3.64, -5.73),vec2(-4.71, 5.60),vec2(-3.85, 2.83),vec2(3.87, 3.89),vec2(-2.70, 7.75),vec2(-4.36, -1.70),vec2(2.62, -3.18),vec2(2.96, 3.50),vec2(-0.81, -0.62),vec2(0.42, 4.28),vec2(3.38, -2.27),vec2(-1.68, -2.69),vec2(4.64, -8.11),vec2(3.75, -5.29),vec2(-4.54, 0.46),vec2(-1.87, -0.82),vec2(-2.31, 2.15),vec2(0.01, 7.26),vec2(-0.96, 3.64),vec2(3.69, -2.68),vec2(2.13, -8.18),vec2(-4.30, 2.88),vec2(1.92, 0.09),vec2(3.18, 4.96),vec2(-5.34, 3.84),vec2(0.39, -7.94),vec2(-1.92, 5.45),vec2(-3.45, 0.36),vec2(-2.78, 3.03),vec2(-0.82, 2.81),vec2(-2.30, 4.38),vec2(4.15, 0.48),vec2(-3.41, -7.76),vec2(4.56, -5.66),vec2(3.68, -7.04),vec2(4.77, -2.98),vec2(4.42, -1.22),vec2(-4.21, 1.40),vec2(4.33, 2.47),vec2(-0.44, 4.50),vec2(-2.84, 1.77),vec2(0.99, -7.17),vec2(-0.83, -6.41),vec2(4.24, -0.53),vec2(2.36, -5.44),vec2(-3.02, -7.33),vec2(1.95, 5.41),vec2(5.15, -4.02),vec2(-0.32, -4.50),vec2(1.92, 5.52),vec2(2.40, 2.08),vec2(-0.76, -0.31),vec2(-0.70, 1.05),vec2(4.91, 4.78),vec2(-4.68, -1.65),vec2(2.57, -1.19),vec2(-4.82, -5.20),vec2(1.90, -1.08),vec2(1.77, 2.40),vec2(-0.67, -2.68),vec2(-4.51, 3.92),vec2(-2.22, 2.05),vec2(-0.46, -0.08),vec2(-0.99, -4.94),vec2(-0.87, 4.60),vec2(-4.29, 5.92),vec2(4.63, -6.89),vec2(-3.48, -3.26),vec2(2.40, 0.52),vec2(-2.54, -6.10),vec2(2.23, -1.56),vec2(2.40, 4.57),vec2(-0.68, 6.26),vec2(3.21, 0.99),vec2(-4.90, -8.00),vec2(-4.17, -8.04),vec2(-0.21, 5.05),vec2(-5.23, 0.48),vec2(-0.31, -5.06),vec2(1.59, -5.37),vec2(-2.77, 6.50),vec2(-4.32, 7.00),vec2(-0.14, -1.50),vec2(-2.00, -4.05),vec2(-1.73, 5.16),vec2(1.81, -0.91),vec2(-0.43, 0.78),vec2(3.87, -7.13),vec2(-3.66, 5.16),vec2(-0.77, 6.54),vec2(-0.95, -1.23),vec2(-1.35, 7.19),vec2(0.66, 6.39),vec2(5.29, 7.65),vec2(1.42, -4.98),vec2(-1.36, 2.36),vec2(4.81, -0.09),vec2(-5.41, -7.43),vec2(2.55, -4.04),vec2(1.15, -3.87),vec2(5.52, -7.30),vec2(-4.44, -2.35),vec2(-4.58, -6.41),vec2(-3.01, 4.63),vec2(0.13, 3.72),vec2(-2.74, 2.55),vec2(-5.30, 1.78),vec2(-3.55, 3.58),vec2(1.76, -1.87),vec2(-1.38, -0.19),vec2(4.63, -1.85),vec2(-2.98, 0.01),vec2(-3.78, -1.73),vec2(3.85, -1.77),vec2(-2.03, -5.35),vec2(-0.85, -1.33),vec2(-0.70, -7.86),vec2(0.46, -0.29),vec2(0.29, 0.51),vec2(-2.27, -6.17),vec2(-3.37, -6.47),vec2(-2.90, -2.48),vec2(-4.80, 2.79),vec2(-4.81, 4.88),vec2(1.57, 0.91),vec2(-3.83, 4.76),vec2(5.50, -5.27),vec2(4.61, -8.08),vec2(1.72, 5.37),vec2(-3.42, 2.99),vec2(1.68, 6.43),vec2(4.51, -4.47),vec2(3.71, 6.48),vec2(1.35, 7.24));
// Sigmas (scales)
vec2 gauss_sigmas[NUM_GAUSSIANS] = vec2[NUM_GAUSSIANS](vec2(0.49, 0.91),vec2(1.80, 0.75),vec2(0.85, 0.40),vec2(1.54, 0.79),vec2(0.70, 1.36),vec2(1.25, 0.26),vec2(0.09, -0.35),vec2(0.45, 0.36),vec2(-0.00, -0.07),vec2(0.99, 0.64),vec2(0.54, 1.05),vec2(0.48, 0.32),vec2(-0.41, -0.68),vec2(-0.38, -0.52),vec2(0.25, 0.72),vec2(-0.56, 0.10),vec2(-0.00, 0.08),vec2(0.36, 0.71),vec2(0.25, 0.73),vec2(0.52, 0.41),vec2(0.67, 0.61),vec2(-0.20, -0.33),vec2(-0.60, -0.34),vec2(0.60, 0.07),vec2(-0.12, -0.62),vec2(0.00, -0.01),vec2(-0.28, -0.20),vec2(-0.28, -0.21),vec2(-0.33, -0.37),vec2(0.01, 0.02),vec2(0.95, 0.56),vec2(-0.35, -0.42),vec2(1.24, 0.92),vec2(0.50, 0.74),vec2(0.34, -0.25),vec2(-0.15, 0.09),vec2(-0.25, -0.75),vec2(0.18, 0.47),vec2(-0.50, -0.17),vec2(0.55, 0.90),vec2(-0.07, -0.08),vec2(-0.02, -0.08),vec2(0.53, 0.22),vec2(0.56, -0.36),vec2(0.83, 0.65),vec2(0.19, 0.56),vec2(0.41, 0.47),vec2(0.69, 0.22),vec2(-0.23, -0.38),vec2(-0.54, -0.39),vec2(0.00, 0.01),vec2(-0.07, -0.32),vec2(-0.15, -0.33),vec2(-0.52, -0.17),vec2(0.30, 0.09),vec2(1.46, 1.09),vec2(0.22, 0.61),vec2(0.00, 0.00),vec2(-0.12, 0.21),vec2(-0.21, -0.10),vec2(1.55, 2.46),vec2(-0.26, 0.29),vec2(0.03, -0.01),vec2(-0.14, -0.10),vec2(0.65, -0.15),vec2(0.20, 0.51),vec2(1.40, 0.49),vec2(0.39, 0.55),vec2(0.71, 0.18),vec2(0.75, 1.01),vec2(0.08, 0.35),vec2(-0.40, 0.13),vec2(0.01, 0.00),vec2(0.89, 1.16),vec2(0.42, 0.65),vec2(-0.49, -0.09),vec2(0.39, 0.27),vec2(-0.25, -0.35),vec2(0.57, 0.58),vec2(0.71, 0.29),vec2(0.34, -0.58),vec2(0.38, 0.10),vec2(-0.24, -0.43),vec2(1.24, 0.58),vec2(-0.24, -0.49),vec2(2.15, 2.22),vec2(-0.14, -0.32),vec2(0.36, 1.00),vec2(0.63, 0.13),vec2(-0.23, -0.11),vec2(-0.35, -0.52),vec2(-0.19, -0.26),vec2(0.73, 0.39),vec2(0.20, 0.30),vec2(0.10, -0.70),vec2(0.00, 0.01),vec2(0.67, 0.50),vec2(0.94, 1.55),vec2(-0.15, -0.61),vec2(0.63, 0.28),vec2(0.69, 0.13),vec2(-0.36, -0.12),vec2(0.98, 0.28),vec2(-0.51, -0.88),vec2(0.75, 0.74),vec2(0.70, 0.25),vec2(0.19, 0.27),vec2(0.62, 0.60),vec2(0.54, 0.18),vec2(0.45, 1.72),vec2(-0.31, -0.70),vec2(-0.11, -0.07),vec2(0.84, 0.70),vec2(-0.19, -0.31),vec2(0.00, -0.00),vec2(-0.03, 0.05),vec2(-0.24, -0.26),vec2(0.22, -0.53),vec2(-0.68, -0.47),vec2(0.66, 0.13),vec2(-0.42, -0.26),vec2(0.00, 0.00),vec2(-0.10, -0.08),vec2(0.40, 0.66),vec2(-0.11, -0.47),vec2(-0.19, -0.29),vec2(-0.12, -0.21),vec2(-0.14, -0.67),vec2(-0.16, 0.29),vec2(-0.19, -0.33),vec2(0.41, -0.47),vec2(-0.00, -0.03),vec2(-0.72, -0.32),vec2(-0.45, -0.27),vec2(0.39, 0.68),vec2(0.09, -0.22),vec2(0.24, -0.15),vec2(-0.18, -0.25),vec2(0.86, 0.85),vec2(0.33, 0.26),vec2(0.19, -0.57),vec2(0.17, -0.26),vec2(-0.27, -0.21),vec2(-0.04, -0.04),vec2(0.10, 0.54),vec2(-0.01, -0.00),vec2(0.42, 0.55),vec2(-0.60, -0.51),vec2(0.67, 1.07),vec2(0.75, 0.94));
// Rotation angles (thetas)
float gauss_thetas[NUM_GAUSSIANS] = float[NUM_GAUSSIANS](0.29,0.74,0.99,-0.70,0.95,0.04,-0.89,-2.04,1.60,-0.57,0.09,0.64,-0.64,1.03,0.05,2.86,-0.05,0.10,0.13,-0.58,0.93,-1.15,1.47,-0.07,-1.90,0.32,2.00,0.34,-1.33,-0.32,0.39,-0.17,-0.02,1.49,-0.44,-1.76,1.20,0.38,0.35,1.07,-0.19,-0.58,1.11,-1.42,-0.33,0.56,0.23,-0.25,0.46,0.55,-0.15,0.22,0.39,0.12,0.32,-1.28,-1.63,0.99,1.94,-0.40,-0.27,0.00,-0.09,2.17,-0.54,0.56,-0.57,0.89,0.74,0.46,-0.48,-0.00,-0.29,-1.76,0.11,0.79,0.37,-0.20,0.47,-0.85,0.46,0.29,-0.23,0.88,0.62,0.51,-0.49,-0.03,0.30,-0.22,-0.71,2.23,-0.67,0.21,0.82,-0.17,0.14,0.25,-0.69,-0.18,1.10,0.65,0.66,-0.47,0.24,0.20,1.16,-0.63,-0.30,1.47,-1.53,-0.48,-0.62,-0.70,0.68,0.17,1.33,-0.73,2.20,-0.60,0.31,-0.03,-0.99,0.74,-0.36,0.66,1.22,-0.72,-0.56,0.20,-0.45,-0.06,-0.13,0.64,-0.60,-0.04,1.51,0.57,0.75,-0.25,-0.26,0.82,0.51,0.23,0.54,-0.20,0.73,-0.02,0.04,-0.32);
// Colors (RGB)
vec3 gauss_colors[NUM_GAUSSIANS] = vec3[NUM_GAUSSIANS](vec3(0.34, 0.27, 0.08),vec3(0.06, 0.02, 0.07),vec3(0.44, 0.39, 0.14),vec3(0.07, 0.03, 0.02),vec3(0.18, 0.17, 0.08),vec3(-0.19, 0.40, 0.38),vec3(0.21, 0.13, 0.05),vec3(0.68, 0.48, 0.11),vec3(0.27, 0.19, -0.04),vec3(0.03, 0.04, 0.01),vec3(0.36, 0.27, 0.11),vec3(0.35, 0.24, 0.02),vec3(0.07, 0.05, 0.04),vec3(0.54, 0.23, 0.02),vec3(0.43, 0.19, 0.02),vec3(-0.22, -0.16, -0.02),vec3(-0.02, -0.01, -0.04),vec3(0.24, 0.21, 0.10),vec3(0.07, 0.06, 0.02),vec3(0.45, 0.40, 0.11),vec3(0.37, 0.31, 0.13),vec3(0.46, 0.34, 0.02),vec3(0.06, 0.04, 0.02),vec3(0.28, 0.27, 0.11),vec3(-0.17, -0.32, -0.11),vec3(0.27, 0.29, -0.14),vec3(0.02, 0.01, 0.00),vec3(0.03, 0.02, 0.02),vec3(0.13, 0.03, 0.06),vec3(0.05, 0.05, 0.02),vec3(0.24, 0.15, 0.06),vec3(0.18, 0.11, 0.06),vec3(0.16, 0.07, 0.05),vec3(0.38, 0.36, 0.15),vec3(0.78, 0.68, 0.18),vec3(0.03, 0.01, 0.00),vec3(0.21, 0.11, 0.09),vec3(0.11, 0.11, 0.03),vec3(0.60, 0.37, 0.08),vec3(0.47, 0.39, 0.16),vec3(0.30, 0.35, 0.21),vec3(0.17, -0.06, -0.07),vec3(0.41, 0.40, 0.13),vec3(0.34, 0.27, 0.03),vec3(0.07, 0.13, 0.06),vec3(0.85, 0.63, 0.16),vec3(0.60, 0.52, 0.19),vec3(0.41, 0.36, 0.04),vec3(0.03, 0.03, 0.02),vec3(0.03, 0.01, 0.01),vec3(0.17, -0.03, 0.13),vec3(0.10, 0.03, 0.02),vec3(0.25, 0.07, 0.02),vec3(0.14, 0.18, 0.12),vec3(0.09, 0.08, 0.03),vec3(0.07, -0.17, -0.01),vec3(0.20, 0.23, 0.16),vec3(0.04, -0.04, -0.11),vec3(0.08, 0.05, 0.01),vec3(0.26, 0.06, 0.01),vec3(0.06, 0.02, 0.03),vec3(0.03, 0.02, -0.00),vec3(-0.05, -0.09, 0.06),vec3(0.01, 0.01, 0.01),vec3(0.98, 0.54, 0.08),vec3(0.35, 0.31, 0.14),vec3(0.20, 0.17, 0.08),vec3(0.51, 0.31, 0.05),vec3(0.57, 0.36, 0.10),vec3(0.55, 0.45, 0.11),vec3(0.19, 0.11, 0.01),vec3(0.15, 0.10, 0.03),vec3(0.12, -0.12, -0.11),vec3(0.08, 0.03, 0.04),vec3(-0.12, -0.14, -0.03),vec3(0.08, 0.06, 0.02),vec3(0.20, 0.19, 0.08),vec3(0.18, 0.21, 0.07),vec3(0.34, 0.41, 0.20),vec3(0.70, 0.36, 0.05),vec3(0.80, 0.77, 0.20),vec3(-0.06, -0.06, -0.03),vec3(0.03, 0.01, 0.02),vec3(0.13, 0.08, 0.05),vec3(0.16, 0.06, 0.07),vec3(0.09, 0.04, 0.06),vec3(0.28, 0.18, 0.03),vec3(0.21, 0.19, 0.07),vec3(0.30, 0.31, 0.12),vec3(0.38, 0.31, 0.07),vec3(0.07, 0.05, 0.05),vec3(0.20, 0.14, 0.12),vec3(0.92, 0.86, 0.20),vec3(-0.20, -0.15, 0.02),vec3(0.62, 0.34, 0.05),vec3(-0.16, -0.08, -0.01),vec3(0.30, 0.25, 0.10),vec3(0.53, 0.46, 0.20),vec3(0.11, 0.08, 0.04),vec3(0.82, 0.58, 0.13),vec3(0.41, 0.45, 0.21),vec3(0.15, 0.12, 0.04),vec3(0.64, 0.44, 0.11),vec3(0.03, 0.01, 0.01),vec3(0.46, 0.37, 0.14),vec3(0.30, 0.31, 0.10),vec3(0.17, 0.10, 0.04),vec3(0.39, 0.36, 0.13),vec3(0.54, 0.47, 0.13),vec3(0.14, 0.24, 0.14),vec3(0.34, 0.15, 0.04),vec3(0.10, 0.08, 0.04),vec3(0.22, 0.07, 0.04),vec3(0.09, 0.03, 0.06),vec3(0.03, 0.05, -0.06),vec3(0.02, 0.02, 0.01),vec3(0.16, 0.04, 0.04),vec3(0.21, 0.14, 0.04),vec3(0.03, 0.02, 0.02),vec3(0.18, 0.16, 0.11),vec3(0.79, 0.69, 0.15),vec3(0.32, -0.03, -0.07),vec3(-0.07, 0.43, -0.12),vec3(0.14, 0.09, 0.04),vec3(0.14, 0.10, 0.03),vec3(0.45, 0.37, 0.09),vec3(0.30, 0.13, 0.03),vec3(0.29, 0.20, 0.03),vec3(0.43, 0.27, 0.04),vec3(0.09, 0.05, 0.02),vec3(0.77, 0.43, 0.06),vec3(0.32, -0.04, -0.13),vec3(0.07, 0.05, 0.03),vec3(0.64, 0.47, 0.11),vec3(0.78, 0.57, 0.16),vec3(0.36, 0.15, 0.03),vec3(0.02, 0.02, 0.01),vec3(0.11, 0.07, 0.02),vec3(0.09, 0.09, 0.07),vec3(0.30, 0.25, 0.09),vec3(0.34, 0.12, 0.06),vec3(0.24, 0.21, 0.11),vec3(0.46, 0.06, 0.10),vec3(0.03, -0.11, -0.00),vec3(0.40, 0.35, 0.11),vec3(0.08, -0.09, 0.13),vec3(0.29, 0.24, 0.10),vec3(0.03, 0.01, 0.01),vec3(0.51, 0.43, 0.18),vec3(0.37, 0.32, 0.12));

/* Dune --- EXTREME LAG
// Number of Gaussians
const int NUM_GAUSSIANS = 300;
// Dimensions [x_min, x_max, y_min, y_max]
float dim[4] = float[4](-5.0,5.0,-7.765151515151515,7.765151515151515);
// Centers (x, y coordinates)
vec2 gauss_centers[NUM_GAUSSIANS] = vec2[NUM_GAUSSIANS](vec2(4.70, 4.57),vec2(-2.28, 4.18),vec2(4.87, 8.18),vec2(0.61, 6.13),vec2(-3.43, -2.41),vec2(-2.22, 0.83),vec2(-2.40, 3.72),vec2(4.42, 2.51),vec2(0.24, 0.87),vec2(-4.27, 3.41),vec2(2.93, -8.20),vec2(0.55, -5.60),vec2(3.63, 6.58),vec2(-2.85, -0.28),vec2(5.25, -3.25),vec2(-3.85, 0.71),vec2(1.11, -2.59),vec2(-4.56, -1.39),vec2(-4.48, 3.32),vec2(-2.46, -6.95),vec2(1.16, -4.42),vec2(-2.45, -3.95),vec2(-1.63, 7.81),vec2(-3.60, -4.29),vec2(-2.57, -8.38),vec2(2.25, 0.86),vec2(-1.87, 0.27),vec2(-5.08, 0.57),vec2(2.35, -0.37),vec2(3.17, -6.84),vec2(3.46, 6.03),vec2(0.49, 0.49),vec2(-1.00, -2.47),vec2(-2.45, -6.21),vec2(5.29, 7.14),vec2(4.32, 2.30),vec2(-4.73, -5.25),vec2(2.11, 0.60),vec2(-0.94, 0.59),vec2(1.43, -3.37),vec2(3.61, -2.41),vec2(-4.95, 3.64),vec2(-2.64, -2.37),vec2(4.41, -8.05),vec2(-4.48, 3.39),vec2(-3.80, 8.06),vec2(-3.67, -4.25),vec2(4.05, -5.44),vec2(-0.04, -7.13),vec2(5.50, -0.81),vec2(-2.10, -1.31),vec2(4.43, -3.81),vec2(-3.58, -0.38),vec2(-4.09, 0.12),vec2(0.16, 2.34),vec2(-2.92, 4.49),vec2(3.61, -0.32),vec2(0.62, -3.30),vec2(-5.31, -4.55),vec2(0.77, 5.15),vec2(-1.54, -4.04),vec2(-0.79, 7.58),vec2(-0.88, -1.41),vec2(-4.49, -0.66),vec2(0.35, 2.14),vec2(-1.47, -7.11),vec2(-2.77, 7.34),vec2(4.59, -1.49),vec2(-1.82, 6.86),vec2(-3.36, -6.72),vec2(0.81, 4.41),vec2(5.40, -5.27),vec2(2.25, 5.86),vec2(-2.13, -2.00),vec2(3.87, 1.58),vec2(3.74, -1.58),vec2(1.49, 5.60),vec2(-3.19, -0.21),vec2(-5.35, 2.52),vec2(1.95, -4.06),vec2(3.20, 2.15),vec2(-5.44, -6.47),vec2(-2.49, -5.28),vec2(5.05, 0.90),vec2(5.39, -4.30),vec2(-3.82, 5.73),vec2(-0.91, 1.82),vec2(2.88, -1.47),vec2(-4.06, -4.94),vec2(4.30, 5.62),vec2(2.97, 5.51),vec2(1.29, -0.80),vec2(-0.66, 0.40),vec2(5.20, 1.57),vec2(4.45, -2.61),vec2(5.17, 0.59),vec2(-4.18, -5.19),vec2(3.34, -7.28),vec2(-1.28, -2.93),vec2(-3.92, 6.31),vec2(3.93, 0.21),vec2(-3.97, -3.28),vec2(1.58, -1.23),vec2(-3.87, 2.31),vec2(-1.50, 5.81),vec2(-4.55, -4.48),vec2(-5.22, -5.59),vec2(2.71, 7.84),vec2(4.99, -1.74),vec2(3.64, 7.11),vec2(-1.52, -4.90),vec2(3.10, -1.90),vec2(5.49, -4.53),vec2(-0.67, 5.70),vec2(1.51, 6.34),vec2(-4.72, 2.59),vec2(-4.99, -0.96),vec2(-1.28, 4.01),vec2(1.65, -4.15),vec2(1.90, -0.87),vec2(3.20, -3.42),vec2(-4.66, 7.95),vec2(2.09, 1.83),vec2(-0.18, 0.22),vec2(1.96, -8.23),vec2(2.34, 3.64),vec2(-5.08, 5.32),vec2(3.73, 1.51),vec2(3.11, 1.29),vec2(3.10, -8.13),vec2(3.03, 6.43),vec2(-3.92, -1.85),vec2(-2.00, -3.79),vec2(-2.10, 6.34),vec2(-3.51, -6.80),vec2(3.27, 6.59),vec2(1.59, 4.39),vec2(-0.82, -2.96),vec2(-3.90, -1.38),vec2(3.22, 2.00),vec2(0.44, -0.81),vec2(-3.96, 5.31),vec2(3.96, 6.28),vec2(-1.67, -0.05),vec2(-2.42, 6.51),vec2(4.67, 7.23),vec2(-4.05, -5.73),vec2(-5.27, -2.72),vec2(1.21, 1.22),vec2(-1.83, -5.36),vec2(-4.24, -4.43),vec2(0.91, 2.03),vec2(-4.62, -3.23),vec2(1.94, -3.11),vec2(5.13, 5.31),vec2(-3.08, -3.89),vec2(-2.79, -0.63),vec2(-3.23, 4.71),vec2(3.26, -2.30),vec2(-3.21, -2.90),vec2(1.73, -5.02),vec2(-4.72, -0.05),vec2(-3.76, -0.97),vec2(-3.28, -3.28),vec2(4.45, -3.49),vec2(0.80, -4.31),vec2(-0.32, 1.20),vec2(-0.24, 2.66),vec2(1.31, -5.81),vec2(1.19, -7.56),vec2(-0.30, -1.84),vec2(1.28, 8.11),vec2(2.79, 0.91),vec2(-4.69, 6.86),vec2(4.74, 6.30),vec2(-1.07, -7.08),vec2(3.40, -3.71),vec2(3.98, -0.70),vec2(-5.36, -3.36),vec2(-1.99, -6.74),vec2(1.23, -0.26),vec2(1.95, 0.64),vec2(2.21, -7.11),vec2(-1.90, -5.02),vec2(-2.61, 0.90),vec2(-1.61, 0.90),vec2(-1.59, 0.95),vec2(2.65, 0.56),vec2(3.28, -3.38),vec2(4.55, -1.20),vec2(-4.87, -0.42),vec2(-2.65, -1.37),vec2(-3.51, 7.57),vec2(3.69, -4.71),vec2(-3.19, 2.81),vec2(-4.88, 2.81),vec2(-1.93, 5.24),vec2(3.82, 3.35),vec2(0.94, -1.44),vec2(-3.16, -2.09),vec2(-0.22, 4.37),vec2(-4.80, 1.70),vec2(-3.89, -3.42),vec2(3.49, -1.39),vec2(0.34, 7.61),vec2(-2.36, 0.04),vec2(3.42, 4.83),vec2(-4.70, -7.25),vec2(5.06, 3.55),vec2(-0.49, 0.42),vec2(0.88, -6.81),vec2(2.52, -3.26),vec2(-1.75, 3.40),vec2(2.78, 6.47),vec2(-1.94, 1.64),vec2(-0.55, -6.73),vec2(0.19, -3.20),vec2(1.50, -1.46),vec2(-5.43, 7.04),vec2(-0.07, 5.93),vec2(-1.04, 2.69),vec2(4.16, -1.97),vec2(4.00, -0.56),vec2(-0.33, 0.13),vec2(-3.26, 3.57),vec2(5.05, -3.91),vec2(-5.40, -1.34),vec2(3.46, 1.86),vec2(-1.20, 1.18),vec2(3.99, 1.21),vec2(1.38, 6.99),vec2(2.06, -4.57),vec2(1.18, 0.64),vec2(2.47, -1.57),vec2(-1.16, -5.54),vec2(-0.86, 3.76),vec2(-4.35, 4.86),vec2(-5.38, 1.30),vec2(4.05, -4.95),vec2(3.39, -0.82),vec2(0.10, 6.03),vec2(-1.75, 2.03),vec2(1.40, -5.00),vec2(0.88, 0.32),vec2(3.78, 8.18),vec2(-3.46, -5.36),vec2(1.43, -1.54),vec2(5.44, -5.88),vec2(-3.70, -1.25),vec2(0.99, -6.34),vec2(-3.30, 5.81),vec2(0.98, 2.94),vec2(1.86, -3.39),vec2(-2.16, -2.53),vec2(-2.33, 4.06),vec2(5.22, 0.36),vec2(1.10, 4.40),vec2(-1.20, 6.41),vec2(-2.06, -0.55),vec2(4.85, -1.52),vec2(2.37, 5.02),vec2(3.96, -0.61),vec2(-2.74, 0.47),vec2(-1.12, -1.07),vec2(3.39, -2.43),vec2(5.08, -2.77),vec2(-3.41, 2.37),vec2(0.72, -3.66),vec2(1.84, -6.66),vec2(0.00, -1.47),vec2(-3.45, -3.13),vec2(-0.16, 4.73),vec2(-1.28, -0.95),vec2(-3.47, -3.21),vec2(-3.12, -1.55),vec2(-0.39, 6.64),vec2(-4.16, 1.48),vec2(-0.02, 2.03),vec2(-0.48, -2.76),vec2(-3.10, 0.15),vec2(-2.89, 1.83),vec2(-0.50, 3.02),vec2(2.43, 0.06),vec2(2.28, 3.54),vec2(4.07, -3.93),vec2(3.77, 7.96),vec2(3.84, -1.43),vec2(3.92, -5.66),vec2(2.46, 3.45),vec2(1.33, -0.31),vec2(-3.93, 2.88),vec2(3.40, 4.82),vec2(-2.50, 7.57),vec2(-5.19, 0.38),vec2(4.58, -1.50),vec2(-4.40, -3.90),vec2(4.08, 6.70),vec2(-2.87, 2.09),vec2(-0.30, -0.47),vec2(0.29, -2.33));
// Sigmas (scales)
vec2 gauss_sigmas[NUM_GAUSSIANS] = vec2[NUM_GAUSSIANS](vec2(0.85, 0.50),vec2(-0.26, -0.18),vec2(0.41, 0.33),vec2(0.58, 0.42),vec2(-0.01, -0.16),vec2(-0.26, -0.20),vec2(-0.00, 0.00),vec2(0.86, 0.40),vec2(0.93, 0.35),vec2(-0.11, -0.17),vec2(-0.15, -0.10),vec2(0.09, -0.29),vec2(0.14, 0.17),vec2(0.00, -0.01),vec2(-0.10, -0.11),vec2(-0.48, -0.50),vec2(0.03, 0.14),vec2(0.77, 1.24),vec2(-0.15, -0.46),vec2(0.44, 1.26),vec2(1.00, 0.86),vec2(-0.11, -0.09),vec2(0.52, 0.61),vec2(-0.35, -0.61),vec2(0.35, 1.01),vec2(0.40, -0.17),vec2(0.19, -0.08),vec2(-0.49, -0.60),vec2(-0.00, 0.01),vec2(-0.01, -0.16),vec2(0.38, 0.47),vec2(-0.72, -0.19),vec2(-0.13, -0.46),vec2(-0.17, -0.05),vec2(0.28, 1.38),vec2(0.12, -0.22),vec2(0.04, 0.00),vec2(-1.10, 0.09),vec2(0.20, 0.09),vec2(0.04, 0.24),vec2(0.94, 1.41),vec2(0.33, 0.73),vec2(-0.26, -0.08),vec2(1.29, 0.70),vec2(-0.21, -0.42),vec2(-0.49, -0.20),vec2(-0.25, -0.17),vec2(-0.19, 0.10),vec2(-0.04, 0.53),vec2(-0.30, -0.21),vec2(-0.24, -0.49),vec2(-0.16, -0.02),vec2(-0.01, 0.01),vec2(0.25, 0.48),vec2(0.12, 0.86),vec2(-0.15, 0.04),vec2(0.98, 0.48),vec2(1.32, 0.57),vec2(-0.47, -0.34),vec2(-0.09, -0.28),vec2(-0.29, -0.11),vec2(0.71, 0.64),vec2(-0.32, -0.15),vec2(0.58, 0.25),vec2(0.79, 0.29),vec2(0.98, 0.41),vec2(0.48, 0.28),vec2(-0.06, -0.41),vec2(0.64, 0.28),vec2(-0.62, -0.04),vec2(0.14, 0.67),vec2(-0.11, -0.13),vec2(0.45, 0.52),vec2(0.00, 0.01),vec2(0.21, 0.37),vec2(-0.55, -0.12),vec2(0.52, 0.60),vec2(-0.34, -0.40),vec2(-0.00, -0.06),vec2(0.05, 0.02),vec2(0.57, 0.84),vec2(-0.07, -0.16),vec2(-0.00, 0.04),vec2(0.52, 0.25),vec2(-0.17, -0.08),vec2(0.99, -0.26),vec2(0.39, 0.26),vec2(0.23, 0.08),vec2(-0.04, -0.27),vec2(0.86, 0.48),vec2(0.29, 0.36),vec2(-0.00, 0.02),vec2(1.26, 1.78),vec2(0.23, 0.52),vec2(-0.08, -0.04),vec2(0.05, -0.01),vec2(-0.29, -0.35),vec2(0.77, 0.41),vec2(-0.14, 0.03),vec2(0.76, 0.49),vec2(-0.52, -0.27),vec2(0.07, 0.02),vec2(-0.23, 0.57),vec2(0.02, 0.00),vec2(-0.15, -0.43),vec2(-0.36, -0.20),vec2(-0.51, -0.42),vec2(0.79, 0.63),vec2(-0.18, -0.32),vec2(0.47, 0.48),vec2(1.95, 1.47),vec2(-0.49, -0.28),vec2(-0.19, -0.11),vec2(-0.40, -0.13),vec2(0.37, 0.27),vec2(-0.32, -0.07),vec2(-0.00, -0.01),vec2(0.64, -0.14),vec2(-0.27, -0.05),vec2(0.00, -0.01),vec2(-0.01, -0.01),vec2(0.54, 0.64),vec2(0.46, 0.79),vec2(0.27, -0.04),vec2(-0.13, -0.10),vec2(0.74, 0.59),vec2(0.87, 0.64),vec2(0.70, 0.21),vec2(0.50, 0.39),vec2(-0.06, -0.10),vec2(0.18, 0.00),vec2(-0.00, -0.01),vec2(-0.14, -0.17),vec2(0.17, -0.06),vec2(-0.00, 0.00),vec2(0.08, 0.26),vec2(0.40, 0.63),vec2(-0.02, 0.00),vec2(-0.09, -0.43),vec2(0.56, 0.83),vec2(-0.35, -0.10),vec2(-0.09, 0.30),vec2(0.25, 0.30),vec2(-0.01, 0.02),vec2(0.46, 0.15),vec2(0.66, 0.85),vec2(0.00, -0.00),vec2(0.31, 0.50),vec2(0.59, 0.89),vec2(0.03, 0.28),vec2(-0.02, -0.04),vec2(0.50, 0.57),vec2(-0.66, -0.39),vec2(-0.01, 0.01),vec2(0.89, 0.60),vec2(0.00, -0.04),vec2(-0.13, -0.27),vec2(-0.64, -0.45),vec2(0.08, -0.03),vec2(-0.00, -0.05),vec2(0.02, -0.11),vec2(-0.04, 0.00),vec2(-0.03, -0.01),vec2(-0.34, -0.22),vec2(0.03, -0.20),vec2(-0.00, 0.01),vec2(-0.52, -0.05),vec2(0.58, 0.16),vec2(-0.02, -0.14),vec2(1.72, 1.34),vec2(-0.07, -0.02),vec2(0.67, 0.38),vec2(-0.19, -0.07),vec2(0.50, 0.55),vec2(0.69, 0.41),vec2(-0.01, -0.19),vec2(0.00, -0.00),vec2(-0.02, -0.11),vec2(-0.05, -0.07),vec2(-0.27, 0.03),vec2(0.82, 0.19),vec2(0.26, 0.01),vec2(-0.14, -0.47),vec2(0.27, 0.46),vec2(0.01, 0.00),vec2(-0.93, 0.22),vec2(-0.03, 0.00),vec2(0.58, 0.04),vec2(-0.02, -0.22),vec2(-0.00, -0.06),vec2(0.06, 0.18),vec2(0.16, 0.03),vec2(0.68, 0.75),vec2(1.38, 1.83),vec2(-0.11, -0.27),vec2(0.44, 0.17),vec2(-0.73, -0.91),vec2(0.54, 0.54),vec2(-0.01, 0.00),vec2(-0.13, -0.13),vec2(0.77, 0.54),vec2(-0.39, -0.51),vec2(-0.08, -0.34),vec2(-0.51, -0.03),vec2(0.68, 0.67),vec2(0.04, 0.00),vec2(0.70, 0.67),vec2(1.94, 1.74),vec2(0.90, 0.69),vec2(-0.25, -0.29),vec2(-0.35, -0.14),vec2(0.01, -0.00),vec2(0.10, 0.06),vec2(0.70, 0.68),vec2(-0.01, -0.02),vec2(-0.66, -0.04),vec2(0.04, 0.20),vec2(0.82, 0.11),vec2(0.44, 0.96),vec2(0.82, 0.09),vec2(0.16, 0.53),vec2(-0.25, -0.38),vec2(0.01, -0.00),vec2(-0.57, 0.08),vec2(0.05, 0.00),vec2(-0.37, -0.31),vec2(-0.13, -0.22),vec2(-0.02, -0.00),vec2(0.06, -0.07),vec2(0.60, 0.11),vec2(0.72, 0.58),vec2(0.18, -0.05),vec2(-0.01, -0.00),vec2(0.12, 0.19),vec2(-0.01, -0.00),vec2(0.80, 0.40),vec2(-0.14, -0.37),vec2(-0.09, -0.13),vec2(-0.03, -0.27),vec2(-0.00, -0.01),vec2(0.18, 0.77),vec2(0.44, 0.92),vec2(-0.02, -0.02),vec2(-0.87, -0.04),vec2(0.13, -0.06),vec2(-0.17, -0.02),vec2(1.25, 0.81),vec2(0.96, 1.64),vec2(0.00, 0.00),vec2(0.00, 0.01),vec2(-0.11, -0.46),vec2(0.55, 0.72),vec2(-0.01, -0.04),vec2(1.31, 0.91),vec2(-0.46, -0.32),vec2(-0.41, -0.57),vec2(0.25, 0.64),vec2(0.28, 0.13),vec2(0.14, -0.42),vec2(-0.60, -0.81),vec2(0.47, 0.51),vec2(-0.00, 0.01),vec2(-0.24, 0.02),vec2(-0.01, -0.01),vec2(0.00, -0.00),vec2(-0.54, -0.39),vec2(-0.21, -0.66),vec2(0.00, -0.01),vec2(-0.22, -0.08),vec2(0.06, -0.23),vec2(0.05, -0.00),vec2(0.50, 0.16),vec2(0.03, -0.01),vec2(-0.04, -0.00),vec2(-0.49, -0.18),vec2(0.55, 0.36),vec2(-0.17, -0.25),vec2(0.20, 0.10),vec2(-0.38, -0.16),vec2(-0.53, -0.07),vec2(0.01, 0.01),vec2(0.85, 0.21),vec2(-0.49, -0.14),vec2(0.89, 0.91),vec2(-0.01, 0.01),vec2(0.61, 0.31),vec2(0.00, 0.03),vec2(0.01, 0.01),vec2(0.28, 0.37),vec2(0.00, -0.03),vec2(0.62, 1.38),vec2(0.75, 0.69),vec2(0.55, 0.63),vec2(-0.16, -0.44),vec2(-0.03, -0.21),vec2(-0.49, -0.40),vec2(0.17, 0.13),vec2(0.76, 1.41),vec2(-0.33, -0.07),vec2(-0.22, -0.35));
// Rotation angles (thetas)
float gauss_thetas[NUM_GAUSSIANS] = float[NUM_GAUSSIANS](0.27,0.88,-0.17,-0.74,0.02,-0.88,-0.23,0.24,0.07,-0.22,-0.81,-0.14,-0.28,0.28,-1.34,-1.58,0.55,0.81,0.58,0.35,-0.37,0.45,-0.22,-1.21,1.58,0.08,-0.15,-0.91,-0.88,-0.40,0.69,0.22,0.34,0.07,0.04,0.79,-0.79,0.15,-0.61,0.69,-1.26,-0.15,-0.91,0.42,-0.04,-0.08,-0.91,-0.03,-1.57,-0.13,0.60,-0.36,0.87,1.11,-0.29,-0.02,-0.17,-0.03,-0.94,0.35,-1.20,0.58,-0.73,-0.38,1.28,0.04,0.11,1.53,0.04,0.02,-0.19,0.10,0.99,-0.12,-0.05,-0.05,0.49,1.01,-0.55,-0.17,-0.04,-0.63,-0.79,0.54,0.22,0.76,-1.45,0.06,-1.57,0.12,0.35,0.06,-0.80,0.29,-0.65,-0.48,1.15,0.83,2.35,0.68,-0.56,1.25,-1.47,0.04,1.17,-1.11,0.04,-0.00,-1.57,0.09,-0.25,-0.20,1.32,-0.33,-0.49,0.06,0.14,0.68,-1.27,-0.16,0.93,0.54,-0.37,0.05,-0.37,1.14,1.09,0.58,-0.09,1.34,0.41,0.31,0.44,-0.37,-1.05,0.48,-0.15,0.03,0.23,-0.16,0.48,-0.15,0.63,-0.75,0.24,-0.08,0.95,-0.95,1.20,0.02,-1.24,-0.33,0.52,0.49,-0.21,0.01,-0.33,0.90,-0.86,0.78,0.91,-1.57,-1.14,0.49,1.06,-0.75,1.15,0.38,-0.37,0.07,1.48,-0.23,0.28,-0.32,-0.08,-0.19,-0.81,0.36,0.33,0.06,0.35,-0.85,1.38,0.13,-0.44,-0.71,0.10,0.15,1.14,0.24,1.33,-0.88,0.30,-0.18,0.58,-0.02,0.98,-0.30,-0.38,-1.09,-1.33,-0.69,-0.12,-0.04,-0.43,0.00,0.33,-1.25,0.17,-0.71,0.29,-0.42,0.44,-0.25,-0.62,-0.01,0.14,-0.02,-0.11,-0.62,1.09,-1.77,0.01,0.07,1.10,0.85,0.11,-0.25,-0.94,0.60,-0.12,-0.92,0.09,-0.04,-0.26,0.58,-0.53,0.23,-1.57,0.25,0.97,0.05,1.28,0.11,-0.27,1.68,0.39,-0.17,0.03,-0.01,-0.75,0.67,0.71,0.94,0.60,-0.27,-0.16,-0.54,0.81,0.32,0.03,1.17,-0.21,-1.22,-0.69,1.40,0.10,0.41,-0.44,0.63,0.53,-0.28,0.24,-1.19,-0.72,-0.10,-1.18,1.16,-2.12,2.66,-0.20,0.81,0.15,0.30,0.21,-0.11,0.02,-0.27,0.52,-0.07,-0.10,0.60,-0.29,1.76,1.53,0.11,-0.64,0.30,-0.61,-0.32);
// Colors (RGB)
vec3 gauss_colors[NUM_GAUSSIANS] = vec3[NUM_GAUSSIANS](vec3(0.25, 0.26, 0.25),vec3(-0.02, 0.03, 0.03),vec3(0.17, 0.20, 0.17),vec3(0.39, 0.41, 0.38),vec3(-0.02, -0.02, -0.02),vec3(-0.06, -0.06, -0.06),vec3(0.37, 0.07, 0.01),vec3(0.40, 0.41, 0.35),vec3(0.27, 0.29, 0.24),vec3(-0.27, -0.28, -0.24),vec3(0.17, -0.26, 0.20),vec3(0.01, 0.01, 0.01),vec3(0.02, 0.02, 0.02),vec3(-0.20, -0.00, -0.00),vec3(0.01, 0.05, 0.09),vec3(0.10, 0.09, 0.08),vec3(0.04, 0.03, 0.03),vec3(0.17, 0.15, 0.15),vec3(-0.24, -0.24, -0.22),vec3(0.00, 0.00, 0.01),vec3(0.06, 0.05, 0.05),vec3(0.01, 0.01, 0.01),vec3(0.30, 0.32, 0.28),vec3(0.02, 0.02, 0.02),vec3(0.15, 0.13, 0.12),vec3(0.14, 0.12, 0.12),vec3(-0.05, -0.04, -0.04),vec3(0.13, 0.11, 0.10),vec3(0.00, -0.04, -0.10),vec3(0.06, 0.18, 0.08),vec3(0.15, 0.14, 0.14),vec3(0.21, 0.22, 0.20),vec3(0.06, 0.05, 0.05),vec3(0.01, 0.01, 0.01),vec3(0.20, 0.21, 0.20),vec3(-0.35, -0.48, -0.38),vec3(-0.09, 0.03, -0.02),vec3(0.20, 0.21, 0.17),vec3(0.38, 0.40, 0.36),vec3(-0.04, -0.03, -0.03),vec3(0.11, 0.09, 0.08),vec3(0.61, 0.65, 0.59),vec3(0.04, 0.03, 0.04),vec3(0.06, 0.06, 0.05),vec3(0.62, 0.68, 0.61),vec3(0.13, 0.15, 0.13),vec3(-0.01, -0.01, -0.01),vec3(0.26, 0.26, 0.27),vec3(0.24, 0.27, 0.26),vec3(0.12, 0.10, 0.09),vec3(0.07, 0.06, 0.06),vec3(0.02, 0.02, 0.02),vec3(0.24, 0.03, 0.03),vec3(0.12, 0.10, 0.09),vec3(0.35, 0.37, 0.34),vec3(0.03, 0.04, 0.02),vec3(0.10, 0.07, 0.07),vec3(0.06, 0.05, 0.05),vec3(0.07, 0.06, 0.06),vec3(0.27, 0.27, 0.27),vec3(0.01, 0.01, 0.01),vec3(0.45, 0.47, 0.43),vec3(0.04, 0.03, 0.04),vec3(0.07, 0.06, 0.06),vec3(0.39, 0.42, 0.40),vec3(0.08, 0.07, 0.08),vec3(-0.08, -0.09, -0.08),vec3(0.13, 0.11, 0.10),vec3(0.29, 0.30, 0.27),vec3(0.26, 0.28, 0.28),vec3(0.22, 0.25, 0.22),vec3(0.34, -0.06, 0.07),vec3(0.17, 0.17, 0.16),vec3(0.27, 0.20, 0.27),vec3(0.48, 0.50, 0.46),vec3(0.10, 0.09, 0.07),vec3(0.32, 0.34, 0.31),vec3(0.10, 0.09, 0.08),vec3(-0.11, -0.08, 0.15),vec3(0.03, 0.02, 0.02),vec3(0.16, -0.04, 0.41),vec3(0.09, 0.02, -0.02),vec3(-0.18, -0.07, -0.09),vec3(0.58, 0.50, 0.45),vec3(0.24, 0.19, 0.09),vec3(0.31, 0.33, 0.28),vec3(0.29, 0.19, 0.17),vec3(0.04, 0.03, 0.02),vec3(0.82, 0.84, 0.84),vec3(0.18, 0.19, 0.17),vec3(0.06, 0.06, 0.06),vec3(0.21, -0.24, 0.10),vec3(0.18, 0.14, 0.13),vec3(1.06, 0.99, 0.90),vec3(0.02, 0.02, 0.02),vec3(0.10, 0.08, 0.08),vec3(0.02, 0.02, 0.02),vec3(0.01, 0.01, 0.01),vec3(-0.00, -0.03, -0.03),vec3(0.36, 0.37, 0.34),vec3(0.07, 0.04, 0.04),vec3(0.01, 0.01, 0.01),vec3(-0.07, -0.06, -0.06),vec3(0.39, -0.09, 0.13),vec3(0.07, 0.04, 0.05),vec3(0.02, 0.02, 0.02),vec3(0.03, 0.03, 0.03),vec3(0.46, 0.48, 0.44),vec3(0.07, 0.07, 0.05),vec3(0.20, 0.21, 0.19),vec3(0.11, 0.10, 0.09),vec3(0.07, 0.06, 0.05),vec3(-0.24, -0.07, -0.07),vec3(0.06, 0.00, 0.01),vec3(0.06, 0.06, 0.06),vec3(0.38, 0.42, 0.37),vec3(0.14, 0.37, 0.08),vec3(0.11, 0.11, 0.10),vec3(-0.02, -0.01, -0.01),vec3(0.15, 0.03, -0.03),vec3(0.17, 0.05, 0.02),vec3(0.37, 0.38, 0.34),vec3(0.36, 0.36, 0.32),vec3(0.13, 0.13, 0.10),vec3(0.03, -0.17, 0.22),vec3(0.09, -0.06, 0.18),vec3(0.49, 0.51, 0.46),vec3(-0.12, -0.13, -0.20),vec3(0.73, 0.70, 0.75),vec3(-0.45, 0.10, -0.31),vec3(-0.00, -0.00, -0.00),vec3(0.07, 0.00, 0.12),vec3(-0.02, -0.01, -0.01),vec3(0.37, 0.40, 0.39),vec3(-0.03, 0.09, -0.07),vec3(0.00, 0.01, 0.01),vec3(0.25, 0.23, 0.27),vec3(0.33, 0.05, 0.03),vec3(0.04, 0.03, 0.03),vec3(0.20, 0.40, -0.09),vec3(0.12, 0.10, 0.08),vec3(-0.18, -0.19, -0.12),vec3(0.07, 0.07, 0.07),vec3(0.01, 0.14, -0.01),vec3(0.28, 0.30, 0.28),vec3(0.55, 0.59, 0.53),vec3(-0.03, 0.04, 0.02),vec3(0.09, 0.08, 0.07),vec3(0.29, 0.28, 0.23),vec3(0.72, 0.72, 0.73),vec3(-0.01, -0.01, -0.01),vec3(0.44, 0.45, 0.46),vec3(0.07, 0.07, 0.06),vec3(0.06, 0.06, 0.19),vec3(0.31, 0.33, 0.30),vec3(0.01, 0.02, 0.13),vec3(0.07, 0.06, 0.05),vec3(0.08, 0.04, 0.04),vec3(-0.07, -0.07, -0.05),vec3(-0.02, -0.06, -0.15),vec3(0.73, 0.75, 0.75),vec3(0.11, -0.08, -0.16),vec3(-0.03, -0.04, -0.05),vec3(0.01, 0.01, 0.02),vec3(0.03, 0.02, 0.02),vec3(-0.01, -0.07, 0.01),vec3(0.17, 0.18, 0.15),vec3(0.12, 0.10, 0.10),vec3(0.01, 0.01, 0.01),vec3(0.10, 0.09, 0.09),vec3(0.04, 0.03, 0.03),vec3(0.33, 0.35, 0.31),vec3(0.05, 0.05, 0.03),vec3(0.25, 0.26, 0.23),vec3(0.15, 0.15, 0.15),vec3(-0.13, -0.13, -0.13),vec3(0.02, -0.05, -0.26),vec3(-0.00, -0.00, -0.00),vec3(0.21, 0.06, -0.01),vec3(0.23, 0.24, 0.24),vec3(0.17, 0.12, 0.10),vec3(-0.01, -0.02, 0.00),vec3(0.11, 0.12, 0.12),vec3(-0.02, -0.01, -0.01),vec3(0.04, -0.21, 0.05),vec3(-0.13, -0.12, -0.12),vec3(0.09, 0.11, -0.12),vec3(0.22, 0.22, 0.20),vec3(-0.05, -0.04, -0.04),vec3(-0.02, -0.02, 0.11),vec3(0.03, 0.03, 0.03),vec3(0.10, 0.09, 0.08),vec3(0.46, 0.48, 0.44),vec3(0.10, 0.09, 0.09),vec3(0.10, 0.15, 0.14),vec3(0.31, 0.34, 0.30),vec3(0.15, 0.07, 0.06),vec3(0.19, 0.19, 0.19),vec3(-0.03, -0.07, -0.08),vec3(0.02, 0.02, 0.02),vec3(0.30, 0.21, 0.17),vec3(0.13, 0.10, 0.11),vec3(0.02, 0.02, 0.02),vec3(0.12, 0.10, 0.09),vec3(0.39, 0.41, 0.37),vec3(0.08, -0.02, -0.03),vec3(0.47, 0.18, 0.05),vec3(0.11, 0.10, 0.10),vec3(0.57, 0.59, 0.53),vec3(0.17, 0.19, 0.16),vec3(0.13, 0.14, 0.15),vec3(-0.03, -0.03, 0.18),vec3(0.00, 0.02, 0.03),vec3(0.42, 0.44, 0.40),vec3(0.01, 0.03, 0.09),vec3(0.22, 0.23, 0.24),vec3(0.03, 0.03, 0.03),vec3(0.09, 0.08, 0.07),vec3(0.43, 0.45, 0.41),vec3(0.26, 0.28, 0.26),vec3(0.31, 0.26, 0.23),vec3(0.05, 0.04, 0.03),vec3(-0.31, -0.38, 0.32),vec3(-0.15, -0.15, -0.11),vec3(0.07, -0.03, -0.02),vec3(0.03, 0.02, 0.02),vec3(0.06, 0.10, -0.09),vec3(-0.06, 0.12, -0.10),vec3(0.07, 0.02, 0.01),vec3(0.17, 0.12, 0.06),vec3(0.44, 0.46, 0.42),vec3(0.01, 0.02, 0.01),vec3(-0.01, 0.31, 0.07),vec3(-0.13, -0.11, -0.10),vec3(-0.05, -0.05, -0.02),vec3(0.33, 0.28, 0.26),vec3(0.20, 0.22, 0.20),vec3(0.37, 0.47, -0.10),vec3(0.81, 0.83, 0.84),vec3(0.15, 0.02, -0.37),vec3(0.27, 0.28, 0.26),vec3(0.15, 0.14, 0.13),vec3(-0.13, -0.13, -0.14),vec3(0.21, 0.21, 0.19),vec3(0.10, 0.33, 0.22),vec3(0.54, 0.57, 0.55),vec3(0.20, 0.16, 0.15),vec3(0.06, 0.06, 0.06),vec3(-0.26, -0.38, -0.15),vec3(0.30, 0.14, 0.14),vec3(-0.16, -0.19, -0.13),vec3(0.55, 0.49, 0.54),vec3(-0.09, -0.04, -0.03),vec3(0.06, 0.05, 0.05),vec3(0.09, 0.00, 0.00),vec3(0.17, 0.14, 0.13),vec3(0.29, 0.28, 0.26),vec3(0.44, 0.46, 0.42),vec3(-0.04, -0.04, -0.04),vec3(0.07, 0.05, 0.05),vec3(0.20, 0.19, 0.19),vec3(-0.02, -0.01, -0.16),vec3(-0.02, -0.04, -0.04),vec3(-0.04, -0.03, -0.00),vec3(0.02, 0.01, -0.24),vec3(0.05, 0.04, 0.04),vec3(-0.08, -0.10, -0.10),vec3(-0.01, -0.03, 0.15),vec3(0.20, 0.21, 0.21),vec3(0.03, 0.02, 0.02),vec3(-0.02, -0.02, -0.02),vec3(-0.22, -0.21, -0.17),vec3(-0.07, -0.03, -0.08),vec3(-0.03, -0.00, -0.00),vec3(0.06, 0.05, 0.05),vec3(0.28, 0.29, 0.26),vec3(0.04, 0.05, 0.05),vec3(-0.45, -0.57, -0.53),vec3(0.03, 0.02, 0.02),vec3(-0.06, -0.08, -0.07),vec3(-0.10, 0.20, 0.01),vec3(0.20, 0.15, 0.11),vec3(0.06, 0.02, 0.03),vec3(0.50, 0.64, 0.33),vec3(0.03, 0.03, 0.09),vec3(0.20, 0.22, 0.19),vec3(0.03, 0.03, -0.16),vec3(0.16, 0.29, 0.22),vec3(-0.06, -0.03, -0.02),vec3(0.32, 0.07, -0.11),vec3(0.06, -0.01, -0.01),vec3(-0.09, 0.21, 0.34),vec3(0.41, 0.43, 0.40),vec3(0.06, 0.06, 0.07),vec3(-0.07, -0.07, -0.06),vec3(0.05, 0.04, 0.04),vec3(0.03, 0.02, 0.01),vec3(0.21, 0.20, 0.19),vec3(0.06, 0.07, 0.06),vec3(-0.05, -0.06, -0.05));
*/ 
//======================================================= Copy-Paste Area End =========================================================

/////////////////////////////////////////////////////
//// Here, you are asked to build the inverse covariance matrix, similar to in the 2DGS_A3_solution.ipynb file.
//// You must create the rotation matrix R, the inverse squared sigma matrix D, and the final inverse covariance matrix. 
/////////////////////////////////////////////////////

// This function builds the inverse covariance matrix
mat2 buildSigmaInv(float theta, vec2 sigma)
{
    mat2 cov_mat = mat2(0, 0, 0, 0);

    /////////// 
    // BEGINNING OF YOUR CODE.
    //////////
    
    mat2 R = mat2(
        cos(theta), sin(theta),
        -sin(theta),  cos(theta)
    ); // OMG GLSL is column-major :(

    float eps = 1e-6;
    mat2 D = mat2(
        1.0 / (sigma.x * sigma.x + eps), 0.0,
        0.0, 1.0 / (sigma.y * sigma.y + eps)
    );

    cov_mat = R * D * transpose(R);

    /////////// 
    // END OF YOUR CODE.
    //////////
    return cov_mat;
}

/////////////////////////////////////////////////////
//// Here, you are asked to fill in the necessary components for calculating each gaussian's contribution to the current pixel's color.
//// You must calculate the position of the pixel relative to the gaussian's center, calculate the contribution exponent (pos^T * sigma_inv * pos) 
//// and finally calculate the Gaussian function value that will control the contribution of this specific gaussian.
/////////////////////////////////////////////////////

void mainImage(out vec4 fragColor, in vec2 fragCoord)
{
    float aspect = (dim[1] - dim[0]) / (dim[3] - dim[2]) * iResolution.y / iResolution.x;
    vec2 uv = fragCoord.xy / iResolution.xy; // scale to [0, 1]
    // scale from [-1, 1] to [x_min, x_max] and [y_min, y_max]
    uv.x = mix(dim[0], dim[1], uv.x);
    uv.y = mix(dim[2], dim[3], uv.y);
    if (aspect > 1.0) {
        uv.y *= aspect;
    } else {
        uv.x /= aspect;
    }

    vec3 color = vec3(0.0);

    // Draw bounding box
    float edge = 0.01;
    if (uv.x > dim[0] - edge && uv.x < dim[0] + edge ||
        uv.x > dim[1] - edge && uv.x < dim[1] + edge ||
        ((uv.y > dim[2] - edge && uv.y < dim[2] + edge || uv.y > dim[3] - edge && uv.y < dim[3] + edge) && uv.x > dim[0] && uv.x < dim[1])) {
        color = vec3(1.0, 1.0, 1.0);
    }

    // Animate the Gaussian centers
    uv += smoothstep(0.0, 1.0, cos(iTime)) * cos(iTime + 100.0 * uv.xy) * 3.;

    for (int i = 0; i < NUM_GAUSSIANS; ++i) {
        vec2 center = gauss_centers[i];
        vec2 scale = gauss_sigmas[i];
        float theta = gauss_thetas[i];
        vec3 color_rgb = gauss_colors[i];
        
        // Build inverse covariance matrix
        mat2 sigma_inv = buildSigmaInv(theta, scale);
        float f_x = 0.;

        /////////// 
        // BEGINNING OF YOUR CODE.
        //////////
        
        vec2 pos = uv - center;

        float exponent = dot(pos * sigma_inv, pos);
        f_x = exp(-0.5 * exponent);

        /////////// 
        // END OF YOUR CODE.
        //////////
        
        // Add color contribution
        color += f_x * color_rgb;
    }

    fragColor = vec4(color, 1.0);
}


void main() {
    mainImage(gl_FragColor, gl_FragCoord.xy);
}